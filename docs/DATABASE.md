# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ›¸

**Bite Note** - IndexedDBã‚¹ã‚­ãƒ¼ãƒå®šç¾©

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.0
**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 3
**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ30æ—¥

---

## ğŸ“‹ æ¦‚è¦

Bite Noteã¯**IndexedDB**ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ä½¿ç”¨ã—ã€**Dexie.js**ï¼ˆv3.2.4ï¼‰ã§ãƒ©ãƒƒãƒ—ã—ã¦ã„ã¾ã™ã€‚
å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã«æ°¸ç¶šåŒ–ã•ã‚Œã€å¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡ã¯ä¸€åˆ‡ã‚ã‚Šã¾ã›ã‚“ã€‚

---

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹æˆ

### åŸºæœ¬æƒ…å ±

| é …ç›® | å€¤ |
|------|-----|
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å | `FishingRecordDB` |
| ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | 3 |
| ãƒ©ã‚¤ãƒ–ãƒ©ãƒª | Dexie.js 3.2.4 |
| å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ« | `src/lib/database.ts` |

### ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§

1. **fishing_records** - é‡£æœè¨˜éŒ²ï¼ˆãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼‰
2. **photos** - å†™çœŸãƒ‡ãƒ¼ã‚¿ï¼ˆBlobä¿å­˜ï¼‰
3. **app_settings** - ã‚¢ãƒ—ãƒªè¨­å®š
4. **app_metadata** - ã‚¢ãƒ—ãƒªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
5. **tide_cache** - æ½®æ±è¨ˆç®—çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥
6. **tide_regional_data** - æ½®æ±åœ°åŸŸãƒ‡ãƒ¼ã‚¿
7. **geocode_cache** - ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚­ãƒ£ãƒƒã‚·ãƒ¥

---

## ğŸ“Š ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©

### 1. fishing_recordsï¼ˆé‡£æœè¨˜éŒ²ï¼‰

é‡£æœè¨˜éŒ²ã®ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«

#### ã‚¹ã‚­ãƒ¼ãƒ

| ã‚«ãƒ©ãƒ  | å‹ | å¿…é ˆ | èª¬æ˜ |
|--------|-----|------|------|
| **id** | string | âœ… | UUID v4ï¼ˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ï¼‰ |
| **date** | Date | âœ… | é‡£è¡Œæ—¥æ™‚ |
| **location** | string | âœ… | é‡£ã‚Šå ´æ‰€ |
| **fishSpecies** | string | âœ… | é­šç¨®å |
| size | number | âŒ | ã‚µã‚¤ã‚ºï¼ˆcmï¼‰ |
| weight | number | âŒ | é‡é‡ï¼ˆgï¼‰ |
| weather | string | âŒ | å¤©å€™ |
| temperature | number | âŒ | æ°—æ¸©ï¼ˆâ„ƒï¼‰ |
| weatherData | WeatherData | âŒ | è©³ç´°å¤©æ°—æƒ…å ± |
| photoId | string | âŒ | å†™çœŸIDï¼ˆå¤–éƒ¨ã‚­ãƒ¼ â†’ photos.idï¼‰ |
| coordinates | Coordinates | âŒ | GPSåº§æ¨™ |
| tideInfo | TideInfo | âŒ | æ½®æ±æƒ…å ± |
| tideContext | TideContext | âŒ | æ½®æ±ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ |
| autoFilled | object | âŒ | è‡ªå‹•å…¥åŠ›ãƒ•ãƒ©ã‚° |
| notes | string | âŒ | ãƒ¡ãƒ¢ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆ |
| **createdAt** | Date | âœ… | ä½œæˆæ—¥æ™‚ |
| **updatedAt** | Date | âœ… | æ›´æ–°æ—¥æ™‚ |

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

```typescript
'&id, date, fish_species, location, created_at, [coordinates.latitude+coordinates.longitude]'
```

- `&id` - ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰
- `date` - æ—¥ä»˜ã§é«˜é€Ÿæ¤œç´¢
- `fish_species` - é­šç¨®ã§é«˜é€Ÿæ¤œç´¢
- `location` - å ´æ‰€ã§é«˜é€Ÿæ¤œç´¢
- `created_at` - ä½œæˆæ—¥æ™‚ã§ã‚½ãƒ¼ãƒˆ
- `[coordinates.latitude+coordinates.longitude]` - è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆGPSåº§æ¨™ï¼‰

#### ãƒ‡ãƒ¼ã‚¿ã‚µãƒ³ãƒ—ãƒ«

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "date": "2025-10-30T06:30:00.000Z",
  "location": "æ±äº¬æ¹¾ãƒ»è‹¥æ´²æµ·æµœå…¬åœ’",
  "fishSpecies": "ã‚·ãƒ¼ãƒã‚¹",
  "size": 65,
  "weight": 3200,
  "weather": "æ™´ã‚Œ",
  "temperature": 18,
  "photoId": "photo-uuid-123",
  "coordinates": {
    "latitude": 35.6285,
    "longitude": 139.8275,
    "accuracy": 10
  },
  "tideInfo": {
    "tideType": "å¤§æ½®",
    "currentHeight": 150,
    "tideRange": 180,
    "moonPhase": "æº€æœˆ"
  },
  "notes": "è‰¯å‹ã‚·ãƒ¼ãƒã‚¹ï¼æœãƒãƒ…ãƒ¡ã«æ´»æ€§é«˜ã—",
  "createdAt": "2025-10-30T07:00:00.000Z",
  "updatedAt": "2025-10-30T07:00:00.000Z"
}
```

---

### 2. photosï¼ˆå†™çœŸãƒ‡ãƒ¼ã‚¿ï¼‰

å†™çœŸã®Blobãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«

#### ã‚¹ã‚­ãƒ¼ãƒ

| ã‚«ãƒ©ãƒ  | å‹ | å¿…é ˆ | èª¬æ˜ |
|--------|-----|------|------|
| **id** | string | âœ… | UUID v4ï¼ˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ï¼‰ |
| **blob** | Blob | âœ… | ç”»åƒãƒ‡ãƒ¼ã‚¿æœ¬ä½“ |
| thumbnailBlob | Blob | âŒ | ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒï¼ˆå°ï¼‰ |
| **filename** | string | âœ… | ãƒ•ã‚¡ã‚¤ãƒ«å |
| **mimeType** | string | âœ… | MIMEã‚¿ã‚¤ãƒ—ï¼ˆimage/jpegç­‰ï¼‰ |
| **fileSize** | number | âœ… | ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼ˆãƒã‚¤ãƒˆï¼‰ |
| width | number | âŒ | ç”»åƒå¹…ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰ |
| height | number | âŒ | ç”»åƒé«˜ã•ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰ |
| compressionQuality | number | âŒ | åœ§ç¸®å“è³ªï¼ˆ0-1ï¼‰ |
| **uploadedAt** | Date | âœ… | ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ—¥æ™‚ |

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

```typescript
'&id, uploaded_at, mime_type, file_size'
```

- `&id` - ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼
- `uploaded_at` - ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ—¥æ™‚ã§ã‚½ãƒ¼ãƒˆ
- `mime_type` - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã§ãƒ•ã‚£ãƒ«ã‚¿
- `file_size` - ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã§ãƒ•ã‚£ãƒ«ã‚¿

#### ç‰¹å¾´

- **Blobä¿å­˜**: ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ç›´æ¥IndexedDBã«ä¿å­˜
- **ã‚µãƒ ãƒã‚¤ãƒ«**: ä¸€è¦§è¡¨ç¤ºç”¨ã®å°ã•ã„ç”»åƒã‚’åˆ¥é€”ä¿å­˜
- **å¤–éƒ¨å‚ç…§**: fishing_records.photoIdã‹ã‚‰å‚ç…§

#### ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºç›®å®‰

- ã‚ªãƒªã‚¸ãƒŠãƒ«ç”»åƒ: 500KB - 3MB
- ã‚µãƒ ãƒã‚¤ãƒ«: 20KB - 50KB
- æ¨å¥¨æœ€å¤§ã‚µã‚¤ã‚º: 5MB

---

### 3. app_settingsï¼ˆã‚¢ãƒ—ãƒªè¨­å®šï¼‰

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šã‚’ä¿å­˜ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«

#### ã‚¹ã‚­ãƒ¼ãƒ

| ã‚«ãƒ©ãƒ  | å‹ | å¿…é ˆ | èª¬æ˜ |
|--------|-----|------|------|
| **setting_key** | string | âœ… | è¨­å®šã‚­ãƒ¼ï¼ˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ï¼‰ |
| **setting_value** | string | âœ… | è¨­å®šå€¤ï¼ˆJSONæ–‡å­—åˆ—ï¼‰ |
| **value_type** | string | âœ… | å€¤ã®å‹ï¼ˆstring/number/boolean/objectï¼‰ |
| **updated_at** | Date | âœ… | æ›´æ–°æ—¥æ™‚ |

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

```typescript
'&setting_key, updated_at'
```

#### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š

| ã‚­ãƒ¼ | å€¤ | å‹ | èª¬æ˜ |
|------|-----|-----|------|
| theme | "light" | string | ãƒ†ãƒ¼ãƒï¼ˆlight/dark/autoï¼‰ |
| defaultSort | "date" | string | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚½ãƒ¼ãƒˆé † |
| defaultUseGPS | true | boolean | GPSè‡ªå‹•å–å¾— |
| imageQuality | 0.8 | number | ç”»åƒå“è³ªï¼ˆ0-1ï¼‰ |
| maxImageSize | 5 | number | æœ€å¤§ç”»åƒã‚µã‚¤ã‚ºï¼ˆMBï¼‰ |

#### ãƒ‡ãƒ¼ã‚¿ã‚µãƒ³ãƒ—ãƒ«

```json
{
  "setting_key": "theme",
  "setting_value": "\"dark\"",
  "value_type": "string",
  "updated_at": "2025-10-30T00:00:00.000Z"
}
```

---

### 4. app_metadataï¼ˆã‚¢ãƒ—ãƒªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼‰

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ã‚¿æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«

#### ã‚¹ã‚­ãƒ¼ãƒ

| ã‚«ãƒ©ãƒ  | å‹ | å¿…é ˆ | èª¬æ˜ |
|--------|-----|------|------|
| **meta_key** | string | âœ… | ãƒ¡ã‚¿ã‚­ãƒ¼ï¼ˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ï¼‰ |
| **meta_value** | string | âœ… | ãƒ¡ã‚¿å€¤ |
| **created_at** | Date | âœ… | ä½œæˆæ—¥æ™‚ |
| **updated_at** | Date | âœ… | æ›´æ–°æ—¥æ™‚ |

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

```typescript
'&meta_key, updated_at'
```

#### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿

| ã‚­ãƒ¼ | èª¬æ˜ | ã‚µãƒ³ãƒ—ãƒ«å€¤ |
|------|------|-----------|
| db_version | DBãƒãƒ¼ã‚¸ãƒ§ãƒ³ | "1.0.0" |
| app_version | ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ | "1.0.0" |
| install_date | ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ—¥æ™‚ | "2025-10-30T00:00:00.000Z" |
| last_backup_date | æœ€çµ‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ—¥æ™‚ | "" |
| total_records | ç·è¨˜éŒ²æ•° | "0" |

---

### 5. tide_cacheï¼ˆæ½®æ±ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰

æ½®æ±è¨ˆç®—çµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«

#### ã‚¹ã‚­ãƒ¼ãƒ

| ã‚«ãƒ©ãƒ  | å‹ | å¿…é ˆ | èª¬æ˜ |
|--------|-----|------|------|
| **id** | number | âœ… | è‡ªå‹•æ¡ç•ªIDï¼ˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ï¼‰ |
| **cacheKey** | string | âœ… | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰ |
| tideData | TideInfo | âœ… | æ½®æ±ãƒ‡ãƒ¼ã‚¿ |
| **createdAt** | Date | âœ… | ä½œæˆæ—¥æ™‚ |
| **expiresAt** | Date | âœ… | æœ‰åŠ¹æœŸé™ |
| **lastAccessed** | Date | âœ… | æœ€çµ‚ã‚¢ã‚¯ã‚»ã‚¹æ—¥æ™‚ |

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

```typescript
'++id, cacheKey, createdAt, expiresAt, lastAccessed'
```

- `++id` - è‡ªå‹•æ¡ç•ªãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼
- `cacheKey` - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã§æ¤œç´¢
- `expiresAt` - æœ‰åŠ¹æœŸé™ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- `lastAccessed` - LRUå‰Šé™¤ç”¨

#### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼å½¢å¼

```
tide_{latitude}_{longitude}_{date}
ä¾‹: tide_35.6285_139.8275_20251030
```

#### ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥

- **æœ‰åŠ¹æœŸé™**: 24æ™‚é–“
- **æœ€å¤§ä»¶æ•°**: 100ä»¶ï¼ˆLRUæ–¹å¼ã§å¤ã„ã‚‚ã®ã‚’å‰Šé™¤ï¼‰
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆæ™‚ < 10ms

---

### 6. tide_regional_dataï¼ˆæ½®æ±åœ°åŸŸãƒ‡ãƒ¼ã‚¿ï¼‰

åœ°åŸŸåˆ¥ã®æ½®æ±è£œæ­£ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«

#### ã‚¹ã‚­ãƒ¼ãƒ

| ã‚«ãƒ©ãƒ  | å‹ | å¿…é ˆ | èª¬æ˜ |
|--------|-----|------|------|
| **id** | number | âœ… | è‡ªå‹•æ¡ç•ªIDï¼ˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ï¼‰ |
| **regionId** | string | âœ… | åœ°åŸŸID |
| **latitude** | number | âœ… | ç·¯åº¦ |
| **longitude** | number | âœ… | çµŒåº¦ |
| regionName | string | âœ… | åœ°åŸŸå |
| correctionData | object | âœ… | è£œæ­£ãƒ‡ãƒ¼ã‚¿ |
| **isActive** | boolean | âœ… | æœ‰åŠ¹ãƒ•ãƒ©ã‚° |
| **createdAt** | Date | âœ… | ä½œæˆæ—¥æ™‚ |

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

```typescript
'++id, regionId, [latitude+longitude], isActive, createdAt'
```

- `[latitude+longitude]` - è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆåº§æ¨™æ¤œç´¢ï¼‰

#### ãƒ‡ãƒ¼ã‚¿ã‚µãƒ³ãƒ—ãƒ«

```json
{
  "id": 1,
  "regionId": "tokyo-bay",
  "latitude": 35.6285,
  "longitude": 139.8275,
  "regionName": "æ±äº¬æ¹¾",
  "correctionData": {
    "offset": 0,
    "amplitudeFactor": 1.0
  },
  "isActive": true,
  "createdAt": "2025-10-30T00:00:00.000Z"
}
```

---

### 7. geocode_cacheï¼ˆã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰

GPSåº§æ¨™â†’ä½æ‰€å¤‰æ›çµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«

#### ã‚¹ã‚­ãƒ¼ãƒ

| ã‚«ãƒ©ãƒ  | å‹ | å¿…é ˆ | èª¬æ˜ |
|--------|-----|------|------|
| **id** | number | âœ… | è‡ªå‹•æ¡ç•ªIDï¼ˆãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ï¼‰ |
| **cacheKey** | string | âœ… | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰ |
| **address** | string | âœ… | ä½æ‰€ |
| **timestamp** | number | âœ… | ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼ˆUnixTimeï¼‰ |
| **expiresAt** | number | âœ… | æœ‰åŠ¹æœŸé™ï¼ˆUnixTimeï¼‰ |

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

```typescript
'++id, &cacheKey, expiresAt, timestamp'
```

- `&cacheKey` - ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- `expiresAt` - æœ‰åŠ¹æœŸé™ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

#### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼å½¢å¼

```
geocode_{latitude}_{longitude}
ä¾‹: geocode_35.6285_139.8275
```

#### ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥

- **æœ‰åŠ¹æœŸé™**: 30æ—¥é–“
- **æœ€å¤§ä»¶æ•°**: 500ä»¶

---

## ğŸ”„ ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´

### Version 1 (åˆæœŸãƒªãƒªãƒ¼ã‚¹)

ãƒ†ãƒ¼ãƒ–ãƒ«:
- fishing_records
- photos
- app_settings
- app_metadata

### Version 2 (æ½®æ±ã‚·ã‚¹ãƒ†ãƒ è¿½åŠ )

è¿½åŠ ãƒ†ãƒ¼ãƒ–ãƒ«:
- tide_cache
- tide_regional_data

### Version 3 (ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¿½åŠ )

è¿½åŠ ãƒ†ãƒ¼ãƒ–ãƒ«:
- geocode_cache

---

## ğŸ“ ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºè¦‹ç©ã‚‚ã‚Š

### 1è¨˜éŒ²ã‚ãŸã‚Šã®å¹³å‡ã‚µã‚¤ã‚º

| é …ç›® | ã‚µã‚¤ã‚º |
|------|--------|
| fishing_records | 500 bytes |
| photosï¼ˆ1æšï¼‰ | 1.5 MB |
| tide_cache | 2 KB |
| geocode_cache | 200 bytes |

### ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨é‡è©¦ç®—

| è¨˜éŒ²æ•° | å†™çœŸä»˜ã50% | ç·ã‚µã‚¤ã‚º |
|--------|------------|---------|
| 10ä»¶ | 5æš | ç´„7.5 MB |
| 50ä»¶ | 25æš | ç´„37.5 MB |
| 100ä»¶ | 50æš | ç´„75 MB |
| 500ä»¶ | 250æš | ç´„375 MB |

**æ¨å¥¨**: å†™çœŸã¯é©åº¦ã«æ•´ç†ï¼ˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå¾Œå‰Šé™¤ï¼‰

---

## ğŸ”’ ãƒ‡ãƒ¼ã‚¿ä¿è­·

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥

1. **æ‰‹å‹•ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**
   - JSONãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
   - å†™çœŸã¯Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰

2. **æ¨å¥¨é »åº¦**
   - æœˆ1å›ã®å®šæœŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
   - å¤§é‡ãƒ‡ãƒ¼ã‚¿è¿½åŠ å¾Œ

3. **ä¿å­˜å…ˆ**
   - Googleãƒ‰ãƒ©ã‚¤ãƒ–
   - iCloud
   - ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

### ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ãƒªã‚¹ã‚¯

| æ“ä½œ | å½±éŸ¿ |
|------|------|
| ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ | âŒ ãƒ‡ãƒ¼ã‚¿ä¿æŒ |
| é–²è¦§ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ï¼ˆCookieå«ã‚€ï¼‰ | âœ… **ãƒ‡ãƒ¼ã‚¿å‰Šé™¤** |
| ãƒ–ãƒ©ã‚¦ã‚¶ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« | âœ… **ãƒ‡ãƒ¼ã‚¿å‰Šé™¤** |
| OSã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä¸è¶³ï¼ˆiOSï¼‰ | âš ï¸ è‡ªå‹•å‰Šé™¤ã®å¯èƒ½æ€§ |

---

## ğŸ› ï¸ é–‹ç™ºè€…å‘ã‘æƒ…å ±

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–

```typescript
import { db } from './lib/database';

// ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯è‡ªå‹•çš„ã«åˆæœŸåŒ–ã•ã‚Œã‚‹
// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒè‡ªå‹•æŠ•å…¥ã•ã‚Œã‚‹
```

### ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹

```typescript
// é‡£æœè¨˜éŒ²ã‚’å…¨ä»¶å–å¾—
const records = await db.fishing_records.toArray();

// IDã§å–å¾—
const record = await db.fishing_records.get('uuid-here');

// å†™çœŸå–å¾—
const photo = await db.photos.get('photo-uuid');

// è¨­å®šå–å¾—
const settings = await db.app_settings.toArray();
```

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ´»ç”¨

```typescript
// æ—¥ä»˜ã§ã‚½ãƒ¼ãƒˆ
const sortedRecords = await db.fishing_records
  .orderBy('date')
  .reverse()
  .toArray();

// é­šç¨®ã§ãƒ•ã‚£ãƒ«ã‚¿
const seabassRecords = await db.fishing_records
  .where('fishSpecies')
  .equals('ã‚·ãƒ¼ãƒã‚¹')
  .toArray();

// GPSåº§æ¨™ã§æ¤œç´¢
const nearbyRecords = await db.fishing_records
  .where('[coordinates.latitude+coordinates.longitude]')
  .between([35.0, 139.0], [36.0, 140.0])
  .toArray();
```

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹å ´åˆ:

```typescript
this.version(4).stores({
  // å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å†å®šç¾©
  fishing_records: '...',
  photos: '...',
  // æ–°ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ 
  new_table: '++id, ...'
});
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆã¯`src/__tests__/`ã«é…ç½®:

```bash
npm run test
```

---

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœ

| æ“ä½œ | ä»¶æ•° | æ™‚é–“ |
|------|------|------|
| ä½œæˆ | 1ä»¶ | < 10ms |
| å–å¾—ï¼ˆIDï¼‰ | 1ä»¶ | < 5ms |
| ä¸€è¦§å–å¾— | 100ä»¶ | < 50ms |
| æ¤œç´¢ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼‰ | 100ä»¶ä¸­ | < 30ms |
| å†™çœŸä¿å­˜ | 1æšï¼ˆ2MBï¼‰ | < 200ms |

### æœ€é©åŒ–Tips

1. **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ´»ç”¨**: é »ç¹ã«æ¤œç´¢ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
2. **ã‚µãƒ ãƒã‚¤ãƒ«åˆ©ç”¨**: ä¸€è¦§è¡¨ç¤ºã¯å°ã•ã„ç”»åƒã‚’ä½¿ç”¨
3. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨**: æ½®æ±è¨ˆç®—çµæœã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥
4. **ãƒãƒƒãƒæ“ä½œ**: è¤‡æ•°ä»¶ã®æ“ä½œã¯bulkAdd/bulkPutã‚’ä½¿ç”¨

---

## ğŸ”® ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

- [ ] Version 4: ãƒ•ãƒ«ãƒ†ã‚­ã‚¹ãƒˆæ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- [ ] Version 5: ã‚¿ã‚°æ©Ÿèƒ½ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«
- [ ] Version 6: ã‚½ãƒ¼ã‚·ãƒ£ãƒ«æ©Ÿèƒ½ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå°†æ¥ï¼‰

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ30æ—¥
**ä½œæˆè€…**: Bite Note Development Team
